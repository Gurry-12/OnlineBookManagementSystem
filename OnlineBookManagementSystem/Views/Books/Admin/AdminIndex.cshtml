@{
    ViewData["Title"] = "Admin Dashboard - Whispering Pages";
}
@model OnlineBookManagementSystem.Models.ViewModel.AdminViewModel;
<link href="~/css/BooksIndex.css" rel="stylesheet" />

<!-- 📚 Inspirational Quotes Carousel Section -->
<div class="row mb-4 g-3">
    <div class="col-md-8 col-sm-12">
        <div id="quoteCarousel" class="carousel slide quote-box  shadow-sm rounded" data-bs-ride="carousel" aria-label="Quote Carousel" data-bs-interval="3000">
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <p class="fs-6 fst-italic px-2">“There is more treasure in books than in all the pirate's loot on Treasure Island.”</p>
                    <p class="text-end fw-semibold px-2">- Walt Disney</p>
                </div>
                <div class="carousel-item">
                    <p class="fs-6 fst-italic px-2">“A room without books is like a body without a soul.”</p>
                    <p class="text-end fw-semibold px-2">- Marcus Tullius Cicero</p>
                </div>
                <div class="carousel-item">
                    <p class="fs-6 fst-italic px-2">“So many books, so little time.”</p>
                    <p class="text-end fw-semibold px-2">- Frank Zappa</p>
                </div>
            </div>
            <div class=" d-none d-md-block">
                <small class="text-light fst-italic">— A journey through Whispering Pages</small>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#quoteCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#quoteCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>

    </div>

    <!-- 🧑‍💼 Admin Profile Section (right of carousel) -->
    <div class="col-md-4 col-sm-12">
        <div class="card bg-secondary bg-gradient text-white shadow-lg rounded-4 border-0 h-100">
            <div class="card-body d-flex flex-column justify-content-center align-items-start gap-2">
                <h5 class="card-title fw-semibold"><i class="bi bi-tools me-2"></i>Admin Tools</h5>
                <ul class="list-unstyled ms-1">
                    <li class="mb-2">
                        <i class="bi bi-plus-circle me-2"></i>Add or Update Books
                    </li>
                    <li class="mb-2">
                        <i class="bi bi-person-lines-fill me-2"></i>Manage User Accounts
                    </li>
                    <li class="mb-2">
                        <i class="bi bi-cart-check me-2"></i>View & Process Orders
                    </li>
                    <li class="mb-2">
                        <i class="bi bi-shield-lock me-2"></i>Access Control
                    </li>
                </ul>
                
            </div>
        </div>
    </div>

</div>
<!-- End of row with carousel and profile -->
<!-- 📊 Quick Stats & Recent Activities Section -->
<div class="row g-4 mb-5">
    <!-- Quick Stats -->
    <div class="col-md-6">
        <div class="card shadow-sm rounded-4 bg-white">
            <div class="card-body">
                <h5 class="text-primary mb-3"><i class="bi bi-bar-chart-fill me-2"></i>Quick Stats</h5>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item d-flex justify-content-between">
                        <span><i class="bi bi-book me-2 text-success"></i>Books</span>
                        <span class="badge bg-success rounded-pill">@Model.TotalBooks</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between">
                        <span><i class="bi bi-tags me-2 text-info"></i>Categories</span>
                        <span class="badge bg-info rounded-pill">@Model.TotalCategories</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between">
                        <span><i class="bi bi-people me-2 text-warning"></i>Users</span>
                        <span class="badge bg-warning text-dark rounded-pill">@Model.TotalUsers</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between">
                        <span><i class="bi bi-cart-check me-2 text-danger"></i>Orders</span>
                        <span class="badge bg-danger rounded-pill">@Model.TotalOrders</span>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Recent Activities -->
    <div class="col-md-6">
        <div class="card shadow-sm rounded-4 bg-white">
            <div class="card-body">
                <h5 class="text-primary mb-3"><i class="bi bi-clock-history me-2"></i>Recent Activities</h5>
                <ul class="list-group" style="max-height: 260px; overflow-y: auto;">
                    @if (Model.ActivityLogs != null && Model.ActivityLogs.Any())
                    {
                        foreach (var log in Model.ActivityLogs)
                        {
                            var iconClass = log.ActionType switch
                            {
                                "Add" => "bi bi-book text-success",
                                "Update" => "bi bi-pencil-square text-warning",
                                "Delete" => "bi bi-trash text-danger",
                                "Register" => "bi bi-person-plus text-info",
                                "Login" => "bi bi-box-arrow-in-right text-primary",
                                _ => "bi bi-info-circle text-secondary"
                            };

                            var badgeClass = log.ActionType switch
                            {
                                "Add" => "bg-success",
                                "Update" => "bg-warning text-dark",
                                "Delete" => "bg-danger",
                                "Register" => "bg-info text-dark",
                                "Login" => "bg-primary",
                                _ => "bg-secondary"
                            };

                            <li class="list-group-item d-flex justify-content-between align-items-start">
                                <div class="me-auto">
                                    <i class="@iconClass me-2"></i>@log.Description
                                    <div class="small text-muted">@log.TimeAgo</div>
                                </div>
                                <span class="badge @badgeClass">@log.ActionType</span>
                            </li>
                        }
                    }
                    else
                    {
                        <li class="list-group-item text-muted">No recent activity found.</li>
                    }
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="container mt-4">
    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4">
        <!-- Chart 1 -->
        <div class="col">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h6 class="card-title text-center">Monthly Upload Trends</h6>
                    <canvas id="chart1" height="200"></canvas>
                </div>
            </div>
        </div>
        <!-- Chart 2 -->
        <div class="col">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h6 class="card-title text-center">Book Distribution by Category</h6>
                    <canvas id="chart2" height="200"></canvas>
                </div>
            </div>
        </div>
        <!-- Chart 3 -->
        <div class="col">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h6 class="card-title text-center">Books per Author</h6>
                    <canvas id="chart3" height="200"></canvas>
                </div>
            </div>
        </div>
        <!-- Chart 4 -->
        <div class="col">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h6 class="card-title text-center">Favorites vs Others</h6>
                    <canvas id="chart4" height="200"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- 🔒 Admin-only Controls Section -->
<!-- 🔒 Admin Controls -->
<div id="adminSection" style="display: none;" class="mt-5">
    <h5 class="mb-3"><i class="bi bi-tools me-2"></i>Admin Controls</h5>
    <div class="row g-3 mb-4">

        <!-- Add New Book -->
        <div class="col-md-4 col-sm-6">
            <a asp-controller="Books" asp-action="CreateBookData" class="text-decoration-none">
                <div class="card h-100 shadow-sm border-0 bg-light hover-lift rounded-4 text-center py-4">
                    <div class="card-body">
                        <div class="text-success mb-2" style="font-size: 2rem;">
                            <i class="bi bi-plus-circle-fill"></i>
                        </div>
                        <h6 class="text-dark">Add New Book</h6>
                        <p class="text-muted small">Upload or manage book records</p>
                    </div>
                </div>
            </a>
        </div>

        <!-- Manage Users -->
        <div class="col-md-4 col-sm-6">
            <a asp-controller="Books" asp-action="UserList" class="text-decoration-none">
                <div class="card h-100 shadow-sm border-0 bg-light hover-lift rounded-4 text-center py-4">
                    <div class="card-body">
                        <div class="text-secondary mb-2" style="font-size: 2rem;">
                            <i class="bi bi-person-lines-fill"></i>
                        </div>
                        <h6 class="text-dark">Manage Users</h6>
                        <p class="text-muted small">View, edit or delete users</p>
                    </div>
                </div>
            </a>
        </div>

        <!-- Manage Orders -->
        <div class="col-md-4 col-sm-6">
            <a asp-controller="Order" asp-action="AdminIndex" class="text-decoration-none">
                <div class="card h-100 shadow-sm border-0 bg-light hover-lift rounded-4 text-center py-4">
                    <div class="card-body">
                        <div class="text-danger mb-2" style="font-size: 2rem;">
                            <i class="bi bi-cart-check-fill"></i>
                        </div>
                        <h6 class="text-dark">Manage Orders</h6>
                        <p class="text-muted small">Track and process orders</p>
                    </div>
                </div>
            </a>
        </div>

    </div>

    <!-- 📚 Book Cards Grid -->
    <div class="row g-4" id="bookGrid">
        <!-- Example Card -->
        
    </div>
</div>

<!-- Scripts -->
<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Toastr JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
<script src="~/js/Books/BooksHome.js"></script>
<script src="~/js/books/chartsadmin.js"></script>